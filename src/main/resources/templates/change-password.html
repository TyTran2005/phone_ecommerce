<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
	th:replace="~{/layout::view(~{::title}, ~{::article})}">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Đổi mật khẩu - ShopOnline</title>
</head>
<body>
	<article class="row mt-4">
		<div class="container">
			<div class="row justify-content-center">
				<div class="col-md-6 col-lg-4">
					<div
						class="card change-password-card animate__animated animate__fadeIn">
						<div class="card-body">
							<h4 class="card-title text-center mb-4">Đổi mật khẩu</h4>
							<!-- Hiển thị thông báo lỗi nếu có -->
							<div th:if="${error}" class="alert alert-danger" role="alert"
								th:text="${error}"></div>
							<!-- Hiển thị thông báo thành công nếu có -->
							<div th:if="${success}" class="alert alert-success" role="alert"
								th:text="${success}"></div>
							<form th:action="@{/account/change-password}" method="post">
								<!-- Ô email hiển thị từ account (read-only) với icon -->
								<div class="mb-3 input-icon-container">
									<i class="fas fa-envelope icon-input"></i> <input type="email"
										id="email" name="email" class="form-control with-icon"
										th:value="${account.email}" readonly>
								</div>
								<!-- Ô nhập mật khẩu hiện tại với icon và toggle ẩn/hiện -->
								<div class="mb-3 input-icon-container">
									<i class="fas fa-lock icon-input"></i> <input type="password"
										id="currentPassword" name="currentPassword"
										class="form-control with-icon"
										placeholder="Nhập mật khẩu hiện tại" required> <i
										class="fas fa-eye-slash toggle-icon"
										id="toggleCurrentPassword"></i>
								</div>
								<!-- Ô nhập mật khẩu mới với icon và toggle ẩn/hiện -->
								<div class="mb-3 input-icon-container">
									<i class="fas fa-lock icon-input"></i> <input type="password"
										id="newPassword" name="newPassword"
										class="form-control with-icon" placeholder="Nhập mật khẩu mới"
										required> <i class="fas fa-eye-slash toggle-icon"
										id="toggleNewPassword"></i>
								</div>
								<div class="d-grid">
									<button type="submit" class="btn btn-primary">Đổi mật
										khẩu</button>
								</div>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>
		<script>
			document
					.addEventListener(
							"DOMContentLoaded",
							function() {
								// Toggle cho currentPassword
								const toggleCurrentPassword = document
										.getElementById('toggleCurrentPassword');
								const currentPasswordInput = document
										.getElementById('currentPassword');
								if (toggleCurrentPassword
										&& currentPasswordInput) {
									toggleCurrentPassword
											.addEventListener(
													'click',
													function() {
														if (currentPasswordInput
																.getAttribute('type') === 'password') {
															currentPasswordInput
																	.setAttribute(
																			'type',
																			'text');
															this.classList
																	.remove('fa-eye-slash');
															this.classList
																	.add('fa-eye');
														} else {
															currentPasswordInput
																	.setAttribute(
																			'type',
																			'password');
															this.classList
																	.remove('fa-eye');
															this.classList
																	.add('fa-eye-slash');
														}
													});
								}

								// Toggle cho newPassword
								const toggleNewPassword = document
										.getElementById('toggleNewPassword');
								const newPasswordInput = document
										.getElementById('newPassword');
								if (toggleNewPassword && newPasswordInput) {
									toggleNewPassword
											.addEventListener(
													'click',
													function() {
														if (newPasswordInput
																.getAttribute('type') === 'password') {
															newPasswordInput
																	.setAttribute(
																			'type',
																			'text');
															this.classList
																	.remove('fa-eye-slash');
															this.classList
																	.add('fa-eye');
														} else {
															newPasswordInput
																	.setAttribute(
																			'type',
																			'password');
															this.classList
																	.remove('fa-eye');
															this.classList
																	.add('fa-eye-slash');
														}
													});
								}
							});
		</script>
	</article>
</body>
</html>
